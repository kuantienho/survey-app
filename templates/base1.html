<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Base No.1 | Pen</title>

    <!-- Shared stylesheet -->
    <link rel="stylesheet" href="{{ url_for('static', filename='style_base.css') }}">
  </head>

  <body id="page-base" data-lang="ja">
    <header class="page-header">
      <div>
        <h1>
          <span data-ja>Base No.1 — Pen<br>ベース No.1 — ペン</span>
          <span data-en hidden>Base No.1 — Pen</span>
        </h1>
        <p>
          <span data-ja>Control → Assisted の流れ（約15分）</span>
          <span data-en hidden>Flow from Control to Assisted (approx. 15 min)</span>
        </p>
      </div>

      <div style="display:flex; gap:10px; align-items:center;">
        <div class="lang-switch">
          <button type="button" class="btn btn-secondary" onclick="setLang('ja')">JP</button>
          <button type="button" class="btn btn-secondary" onclick="setLang('en')">EN</button>
        </div>
        <span id="timer-display" class="timer">⏱ 00:00</span>
      </div>
    </header>

    <main class="container">
      <section class="card">
        <h2>
          <span data-ja>ベース対象</span>
          <span data-en hidden>Base Object</span>
        </h2>
        <p>
          <span data-ja>
            <strong>ペン：</strong>
            鉛筆・ボールペン・万年筆・マーカーなどの一般的な筆記具。
            必要に応じて、クリップ・キャップ・ホルダーなど周辺アクセサリも含めて構いません。
          </span>
          <span data-en hidden>
            <strong>Pen:</strong>
            General writing instruments such as pencils, ballpoint pens,
            fountain pens, and markers. Accessories such as clips, caps,
            or holders may be included if relevant.
          </span>
        </p>
      </section>

      <div class="grid">
        <form
          id="form-base1"
          class="card"
          method="POST"
          action="{{ url_for('base1') }}"
          enctype="multipart/form-data"
        >
          <input type="hidden" name="base_id" value="1">
          <input type="hidden" name="base_name" value="Pen">
          <input type="hidden" name="step" value="control">

          <h2>
            <span data-ja>ステップA — ベースの記述</span>
            <span data-en hidden>Step A — Describe the Base</span>
          </h2>

          <label class="block">
            <span data-ja>あなたの理解・前提</span>
            <span data-en hidden>Your understanding / assumptions</span>
            <textarea
              name="base_desc"
              rows="3"
              required
              placeholder="e.g. A portable tool used to mark on paper"
            ></textarea>
          </label>

          <h2 style="margin-top:14px;">
            <span data-ja>ステップB — アイデア1（Control）</span>
            <span data-en hidden>Step B — Idea 1 (Control)</span>
          </h2>

          <label class="block">
            <span data-ja>問題点の記述（3〜5語句）</span>
            <span data-en hidden>Problem descriptors (3–5 words)</span>
            <input
              name="descriptors"
              type="text"
              required
              placeholder="heavy, slippery, dries quickly"
            >
          </label>

          <label class="block">
            <span data-ja>任意のキーワード</span>
            <span data-en hidden>Optional keywords</span>
            <input
              name="keywords"
              type="text"
              placeholder="magnet, refill, eco"
            >
          </label>

          <label class="block">
            <span data-ja>組合理由（2〜3文）</span>
            <span data-en hidden>Reasoning (2–3 sentences)</span>
            <textarea
              name="reason"
              rows="3"
              required
              placeholder="Why this idea? What problem does it solve, and for whom?"
            ></textarea>
          </label>

          <label class="block">
            <span data-ja>提案コンセプト（1〜3文）</span>
            <span data-en hidden>Proposed concept (1–3 sentences)</span>
            <textarea
              name="concept"
              rows="3"
              required
              placeholder="Summarize the core idea."
            ></textarea>
          </label>

          <div class="form-actions">
            <button type="submit" class="btn">
              <span data-ja>送信して続行</span>
              <span data-en hidden>Submit & Continue</span>
            </button>
          </div>
        </form>

        <aside class="card subcard">
          <h2>
            <span data-ja>副加要素（表示例）</span>
            <span data-en hidden>Additive Elements (Examples)</span>
          </h2>
          <div class="chips">
            <div class="chip">滑り止め / Grip</div>
            <div class="chip">軽量化 / Lightweight</div>
            <div class="chip">片手操作 / One-hand use</div>
          </div>

          <div style="margin-top:14px;">
            <h3>
              <span data-ja>送信後</span>
              <span data-en hidden>After submission</span>
            </h3>
            <ol class="muted-ol">
              <li>
                <span data-ja>Contrary 特徴 と Additive 候補が表示されます。</span>
                <span data-en hidden>The system shows Contrary features and Additive candidates.</span>
              </li>
              <li>
                <span data-ja>次にアイデア2（Assisted）を作成します。</span>
                <span data-en hidden>You will then create Idea 2 (Assisted).</span>
              </li>
            </ol>
          </div>
        </aside>
      </div>

      <nav class="page-nav">
        <a class="btn btn-secondary" href="{{ url_for('instructions2') }}">
          <span data-ja>戻る</span>
          <span data-en hidden>Back</span>
        </a>
        <a class="btn btn-secondary" href="{{ url_for('base2') }}">
          <span data-ja>保存して後で再開</span>
          <span data-en hidden>Save & Resume Later</span>
        </a>
      </nav>
    </main>

    <script>
      /* ===== Language toggle ===== */
      function setLang(lang){
        document.body.dataset.lang = lang;
        document.querySelectorAll('[data-ja]').forEach(el=>{
          el.hidden = (lang !== 'ja');
        });
        document.querySelectorAll('[data-en]').forEach(el=>{
          el.hidden = (lang !== 'en');
        });
      }

      /* ===== Timer ===== */
      let startTime, timerInterval;

      function startTimer() {
        const saved = localStorage.getItem('base1Start');
        startTime = saved ? Number(saved) : Date.now();
        localStorage.setItem('base1Start', String(startTime));
        timerInterval = setInterval(updateTimer, 1000);
        updateTimer();
      }

      function updateTimer() {
        const display = document.getElementById('timer-display');
        const elapsed = Math.floor((Date.now() - startTime) / 1000);
        const m = String(Math.floor(elapsed / 60)).padStart(2, '0');
        const s = String(elapsed % 60).padStart(2, '0');
        display.textContent = `⏱ ${m}:${s}`;
      }

      function stopTimer() {
        if (!startTime) return;
        const total = Math.floor((Date.now() - startTime) / 1000);
        localStorage.setItem('base1TimeSpent', String(total));
        clearInterval(timerInterval);
      }

      window.addEventListener('DOMContentLoaded', startTimer);
      window.addEventListener('beforeunload', stopTimer);
    </script>
  </body>
</html>
